---
layout: post
title: 全局（获取视频第一帧图片）
date: 2023-12-07 16:49:40
tags: 全局函数
categories: 函数
---

获取视频第一帧作为封面

<!-- more -->

params：传入视频url
return：第一帧图片url
```ts
export const getFirstFrame = videoUrl => {
	const video = document.createElement('video')
	video.width = 640
	video.height = 360
	video.controls = true
	video.src = videoUrl
	video.className = 'visibleDom'
	video.crossOrigin = 'Anonymous'
  video.currentTime = 1
	document.body.appendChild(video)
	return new Promise((resolve, reject) => {
		video.addEventListener('loadeddata', async () => {
			const canvas = document.createElement('canvas')
			document.body.appendChild(canvas)
			canvas.className = 'visibleDom'
			const ctx = canvas.getContext('2d')
      ctx.drawImage(video, 0, 0, 300, 150)
      const dataURL = canvas.toDataURL()
      resolve(dataURL)
      setTimeout(() => { document.body.removeChild(canvas); document.body.removeChild(video) }, 100 )
		})
		video.addEventListener('error', error => {
			reject(error)
      setTimeout(() => { document.body.appendChild(video) }, 100 )
		})
	})
}
```

样式还是写成全局类名比较方便
```css
.visibleDom {
	position: fixed;
	z-index: -999;
	opacity: 0;
}
```
<!-- more -->
